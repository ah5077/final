<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="performance">
	
	<insert id="performanceRegister">
		insert into
			performance
		values (
			performance_seq.nextval,
			#{ memberId },
			#{ categoryCode },
			#{ locationCode },
			#{ perTitle },
			#{ perDirector },
			#{ perActor },
			#{ theaterNo },
			#{ perTime },
			#{ perContent },
			#{ perImgOriginalFileName },
			#{ perImgRenamedFileName },
			#{ detailImgOriginalFileName },
			#{ detailImgRenamedFileName },
			#{ perRating },
			default,
			default,
			default,
			#{ perStartDate },
			#{ perEndDate }
			
		)
	</insert>
	
	<select id="selectPerformanceList" resultMap="performanceMap">
		select
			*
		from
			performance
		
		<!-- order by
			no desc -->
	</select>
	
	<select id="categoryListView" resultMap="performanceMap">
		select
			*
		from
			performance
		where 
			category_code = #{ category }
	</select>
	
	<select id="getCategoryName" resultType="string">
		select 
			category_name
		from
			category
		where
			category_code = #{ category }
	</select>
	
	<update id="approvePerRegister">
		update 
			performance
		set 
			admin_approval = 'Y'
		where 
			per_no = #{ perNo }
	</update>
	
	<select id="adminApprovalPerList" resultMap="performanceMap">
		select
			*
		from
			performance
		where
			admin_approval = 'N'
		<!-- order by
			no desc -->
	</select>
	
	<select id="companyPerList" resultMap="performanceMap">
		select
			*
		from
			performance
		where
			member_id = #{ memberId } <!-- and admin_approval = 'Y' -->
		<!-- order by
			no desc -->
	</select>
	
	<select id="selectOnePerformance" resultMap="performanceMap">
		select
			*
		from
			performance
		where
			per_no = #{ perNo }
		<!-- order by
			no desc -->
	</select>
	
	<resultMap type="performance" id="performanceMap">
	</resultMap>
	
		<select id="searchHallName" resultMap="performanceHallMap">
		select
			*
		from
			theater
		where
			name like '%'||#{ keyword }||'%'
	</select>
	
	<update id="perUpdate">
		update 
			performance
		set 
			category_code = #{ categoryCode },
			location_code = #{ locationCode },
			per_title = #{ perTitle },
			per_director = #{ perDirector },
			per_actor = #{ perActor },
			per_time = #{ perTime },
			per_content = #{ perContent },
			per_img_original_filename =#{perImgOriginalFileName},
			per_img_renamed_filename=#{perImgRenamedFileName},
			detail_img_original_filename=#{detailImgOriginalFileName},
			detail_img_renamed_filename=#{detailImgRenamedFileName},
			per_rating = #{ perRating },
			per_start_date = #{ perStartDate },
			per_end_date = #{ perEndDate }
		where 
			per_no = #{ perNo }
	</update>
	
	<resultMap type="performanceHall" id="performanceHallMap">
	</resultMap>	
	
	
</mapper>